/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import { threatHuntingValueCounts } from "../funcs/threatHuntingValueCounts.js";
import { ClientSDK, RequestOptions } from "../lib/sdks.js";
import * as operations from "../models/operations/index.js";
import { unwrapAsync } from "../types/fp.js";

export class ThreatHunting extends ClientSDK {
  /**
   * CensEye: Retrieve value counts to discover pivots
   *
   * @remarks
   * Get counts of web assets for specific field-value pairs and combinations of field-value pairs. This is similar to the [CensEye functionality](https://docs.censys.com/docs/platform-threat-hunting-use-censeye-to-build-detections#/) available in the Platform web UI, but it allows you to define specific fields of interest rather than the [default fields](https://docs.censys.com/docs/platform-threat-hunting-use-censeye-to-build-detections#default-pivot-fields) leveraged by the tool in the UI.<br><br>Each array can only target fields within the same nested object. For example, you can combine `host.services.port=80` and `host.services.protocol=SSH` in the same array, but you cannot combine `host.services.port=80` and `host.location.country=”United States”` in the same array. You can input multiple arrays of objects in each API call.<br><br>To use this endpoint, your organization must have access to the Threat Hunting Module. This endpoint costs 1 credit per count condition (array of objects) included in the API call.
   */
  async valueCounts(
    request: operations.V3ThreathuntingValueCountsRequest,
    options?: RequestOptions,
  ): Promise<operations.V3ThreathuntingValueCountsResponse> {
    return unwrapAsync(threatHuntingValueCounts(
      this,
      request,
      options,
    ));
  }
}
