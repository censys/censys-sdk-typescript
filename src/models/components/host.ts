/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v3";
import { remap as remap$ } from "../../lib/primitives.js";
import { safeParse } from "../../lib/schemas.js";
import { Result as SafeParseResult } from "../../types/fp.js";
import { SDKValidationError } from "../errors/sdkvalidationerror.js";
import { Attribute, Attribute$inboundSchema } from "./attribute.js";
import { HostDns, HostDns$inboundSchema } from "./hostdns.js";
import { Label, Label$inboundSchema } from "./label.js";
import { Location, Location$inboundSchema } from "./location.js";
import { Routing, Routing$inboundSchema } from "./routing.js";
import { Service, Service$inboundSchema } from "./service.js";
import { Whois, Whois$inboundSchema } from "./whois.js";

export type Host = {
  autonomousSystem?: Routing | undefined;
  dns?: HostDns | undefined;
  hardware?: Attribute | undefined;
  ip?: string | undefined;
  labels?: Array<Label> | null | undefined;
  location?: Location | undefined;
  operatingSystem?: Attribute | undefined;
  serviceCount?: number | undefined;
  services?: Array<Service> | null | undefined;
  whois?: Whois | undefined;
};

/** @internal */
export const Host$inboundSchema: z.ZodType<Host, z.ZodTypeDef, unknown> = z
  .object({
    autonomous_system: Routing$inboundSchema.optional(),
    dns: HostDns$inboundSchema.optional(),
    hardware: Attribute$inboundSchema.optional(),
    ip: z.string().optional(),
    labels: z.nullable(z.array(Label$inboundSchema)).optional(),
    location: Location$inboundSchema.optional(),
    operating_system: Attribute$inboundSchema.optional(),
    service_count: z.number().int().optional(),
    services: z.nullable(z.array(Service$inboundSchema)).optional(),
    whois: Whois$inboundSchema.optional(),
  }).transform((v) => {
    return remap$(v, {
      "autonomous_system": "autonomousSystem",
      "operating_system": "operatingSystem",
      "service_count": "serviceCount",
    });
  });

export function hostFromJSON(
  jsonString: string,
): SafeParseResult<Host, SDKValidationError> {
  return safeParse(
    jsonString,
    (x) => Host$inboundSchema.parse(JSON.parse(x)),
    `Failed to parse 'Host' from JSON`,
  );
}
